@startuml
title Diagramme de séquence – Réservation automatique avec détection de danger

actor Enseignant
actor Administrateur
participant "Interface Web" as UI
participant "Contrôleur Réservation" as Ctrl
participant "Service Capteurs" as Capteurs
participant "Base de données" as DB
participant "Écran affichage" as Ecran
participant "Service Notification" as Notif

== Réservation ==

Enseignant -> UI : Saisie d'une réservation
UI -> Ctrl : Transmettre les infos (créneau, classe, salle)

== Vérification capteurs ==

Ctrl -> Capteurs : Interroger état de la salle
Capteurs --> Ctrl : Données capteurs (température, CO2, etc.)

alt Conditions normales
    Ctrl -> DB : Enregistrer réservation (état = "validée")
    Ctrl -> Ecran : Mettre à jour planning
    DB --> Ctrl : Confirmation
    Ctrl --> UI : Afficher confirmation à l’enseignant

else Anomalie détectée
    Ctrl -> DB : Enregistrer réservation (état = "refusée - salle non utilisable")
    Ctrl -> Ecran : Afficher message "DANGER"
    Ctrl -> Notif : Envoyer alerte à l’administrateur
    Notif -> Administrateur : Notification "Danger détecté en salle Physique-Chimie"
    DB --> Ctrl : Confirmation
    Ctrl --> UI : Informer réservation refusée + message danger
end

@enduml
